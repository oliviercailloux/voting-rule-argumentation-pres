% Theme used for courses in Paris-Dauphine, starting from 2015, based on theme Brussels, based on theme CambridgeUS by Madhusudan Singh
%
% This file may be distributed and/or modified
%
% 1. under the LaTeX Project Public License and/or
% 2. under the GNU Public License.

\mode<presentation>
\useinnertheme[shadow=true]{rounded}
\usecolortheme{beaver}
% \setbeamerfont{block title}{size={}}
% \setbeamercolor{titlelike}{parent=structure,bg=white}

% \setbeamercolor{subsection in head/foot}{fg=black,bg=white}
% \setbeamercolor*{section in head/foot}{parent=section in head/foot}
\setbeamercolor*{subsection in head/foot}{parent=section in head/foot}
\setbeamercolor*{page number in head/foot}{fg=darkred,bg=gray!10!white}
\setbeamercolor*{framesubtitle}{fg=black}%no effect!?!
\setbeamercolor{first part in head/foot}{use=palette primary, fg=palette primary.fg, bg=palette primary.bg}
\setbeamercolor{second part in head/foot}{use=palette quaternary, fg=palette quaternary.fg, bg=palette quaternary.bg}

\hypersetup{colorlinks=true, linkcolor=blue!70!red, urlcolor=blue}

\defbeamertemplate{headline}{singleline}{%
\hypersetup{linkcolor=.}%
\begin{beamercolorbox}[ht=2.6ex,dp=1ex]{section in head/foot}%
  \insertsectionnavigationhorizontal{\paperwidth}{}{}%
\end{beamercolorbox}%
}
\defbeamertemplate*{headline}{doubleline}{%
\hypersetup{linkcolor=.}%
\begin{beamercolorbox}[ht=2.5ex,dp=1ex]{section in head/foot}%
  \insertsectionnavigationhorizontal{\paperwidth}{}{}%
\end{beamercolorbox}%
\begin{beamercolorbox}[ht=2.5ex,dp=1ex]{subsection in head/foot}%
  \insertsubsectionnavigationhorizontal{\paperwidth}{}{}%
\end{beamercolorbox}
}

% bug corrected, https://bitbucket.org/rivanvx/beamer/issue/195/incorrect-handling-of-empty-shortinstitute
\defbeamertemplate*{footline}{authortitle}{%
	\leavevmode%
	\hbox{%
		\begin{beamercolorbox}[wd=.45\paperwidth,ht=2.25ex,dp=1ex,center]{author in head/foot}%
			\usebeamerfont{author in head/foot}%
			\insertshortauthor%
			\expandafter\beamer@ifempty%
				\expandafter{\beamer@shortinstitute}{}{~~(\insertshortinstitute)}
		\end{beamercolorbox}%
		\begin{beamercolorbox}[wd=.45\paperwidth,ht=2.25ex,dp=1ex,center]{title in head/foot}%
			\usebeamerfont{title in head/foot}\insertshorttitle
		\end{beamercolorbox}%
		\begin{beamercolorbox}[wd=.1\paperwidth,ht=2.25ex,dp=1ex,right]{page number in head/foot}%
			\insertframenumber{} / \inserttotalframenumber\hspace*{2ex}%
		\end{beamercolorbox}%
	}
}

\defbeamertemplate{footline}{onlypage}{%
	\leavevmode%
	\hfill
	\usebeamerfont*{page number in head/foot}
	\usebeamercolor*[fg]{page number in head/foot}
%	\begin{beamercolorbox}[wd=.1\paperwidth,ht=2.25ex,dp=1ex,right]{page number in head/foot}%
		\insertframenumber{} / \inserttotalframenumber\hspace*{2ex}%
%	\end{beamercolorbox}%
}

\defbeamertemplate{footline}{pagebox}{%
	\leavevmode%
	\begin{beamercolorbox}[wd=\paperwidth,ht=2.25ex,dp=1ex,right]{page number in head/foot}%
		\insertframenumber{} / \inserttotalframenumber\hspace*{2ex}%
	\end{beamercolorbox}%
}

\defbeamertemplate{footline}{titlesubtitle}{%
	\leavevmode%
	\hbox{%
		\begin{beamercolorbox}[wd=.45\paperwidth,ht=2.25ex,dp=1ex,center]{first part in head/foot}%
			\usebeamerfont{title in head/foot}%
			\insertshorttitle%
		\end{beamercolorbox}%
		\begin{beamercolorbox}[wd=.45\paperwidth,ht=2.25ex,dp=1ex,center]{second part in head/foot}%
			\usebeamerfont{subtitle in head/foot}%
			\insertshortsubtitle
		\end{beamercolorbox}%
		\begin{beamercolorbox}[wd=.1\paperwidth,ht=2.25ex,dp=1ex,right]{page number in head/foot}%
			\insertframenumber{} / \inserttotalframenumber\hspace*{2ex}%
		\end{beamercolorbox}%
	}
}
%avoids coloring the links according to hyperref linkcolor (which would bypass beamerâ€™s color system); see http://tex.stackexchange.com/questions/203056/changing-url-colors-in-headline-footline-of-beamer-template
\addtobeamertemplate{headline}{\hypersetup{linkcolor=.}}{}
\addtobeamertemplate{footline}{\hypersetup{linkcolor=.}}{}

%\setbeamercolor{block title alerted}{use=alerted text,fg=alerted text.fg,bg=alerted text.fg!20!bg}
%\setbeamercolor{block body alerted}{parent=normal text,use=block title alerted,bg=block title alerted.bg!50!bg}

\definecolor{craneorange}{RGB}{252,187,6}
\definecolor{craneblue}{RGB}{4,6,76}

\setbeamercolor{block title}{use=structure,fg=structure.fg,bg=structure.fg!20!bg}
%\setbeamercolor{block body}{parent=normal text,use=block title,bg=block title.bg!50!bg, fg=black}
\setbeamercolor{block body}{parent=normal text, use=structure, bg=structure.fg!10!bg}

\setbeamercolor{block title example}{use=example text,fg=example text.fg,bg=example text.fg!20!bg}
%parent=normal text,use=block title example,bg=block title example.bg!50!bg
\setbeamercolor{block body example}{parent=normal text, use=example text, bg=example text.fg!10!bg}

\addtobeamertemplate{proof begin}{%
    \setbeamercolor{block title}{fg=black,bg=red!50!white}
    \setbeamercolor{block body}{fg=red, bg=red!30!white}
}{}

\BeforeBeginEnvironment{theorem}{
	\setbeamercolor{block title}{fg=craneblue,bg=craneorange}
	\setbeamercolor{block body}{parent=normal text, fg=craneblue, bg=craneorange!25!bg}
}
\AfterEndEnvironment{theorem}{
 \setbeamercolor{block title}{use=structure,fg=structure.fg,bg=structure.fg!20!bg}
 \setbeamercolor{block body}{parent=normal text, use=structure, bg=structure.fg!10!bg}
}

\setbeamercolor{definition text}{parent=normal text, fg=red!80!black, bg=red}
\BeforeBeginEnvironment{definition}{%
	% Avoids the word "Definition" then parenthesis
	\setbeamertemplate{theorem begin}{%
		\begin{\inserttheoremblockenv}{%
			\ifx\inserttheoremaddition\@empty\else\inserttheoremaddition\fi%
		}%
	}
	\setbeamercolor{block title}{use=definition text, fg=definition text.fg, bg=definition text.fg!20!bg}
	\setbeamercolor{block body}{parent=normal text, use=block title, bg=block title.bg!50!bg}
}
\AfterEndEnvironment{definition}{
 \setbeamercolor{block title}{use=structure,fg=structure.fg,bg=structure.fg!20!bg}
 \setbeamercolor{block body}{parent=normal text, use=structure, bg=structure.fg!10!bg}
}

\mode<all>

